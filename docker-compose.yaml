version: '3.7'

services:
  web:
    build:
      ./src
    image:
      topher200/assertion-context
    env_file:
      ./.env
    restart:
      always

  celery:
    build:
      ./src
    image:
      topher200/assertion-context
    env_file:
      ./.env
    restart:
      always
    command:
      [celery, -A, app.tasks, worker]

  nginx:
    restart:
      always
    build:
      ./nginx
    ports:
      - "80:80"
